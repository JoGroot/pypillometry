
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>API documentation &#8212; pypillometry  documentation</title>
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developers" href="dev.html" />
    <link rel="prev" title="Overview" href="usage.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev.html" title="Developers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Overview"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pypillometry  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-pypillometry.pupildata">
<span id="api-documentation"></span><h1>API documentation<a class="headerlink" href="#module-pypillometry.pupildata" title="Permalink to this headline">¶</a></h1>
<div class="section" id="pupildata-py">
<h2>pupildata.py<a class="headerlink" href="#pupildata-py" title="Permalink to this headline">¶</a></h2>
<p>Main object-oriented entry point</p>
<dl class="class">
<dt id="pypillometry.pupildata.FakePupilData">
<em class="property">class </em><code class="sig-prename descclassname">pypillometry.pupildata.</code><code class="sig-name descname">FakePupilData</code><span class="sig-paren">(</span><em class="sig-param">pupil</em>, <em class="sig-param">sampling_rate=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">event_onsets=None</em>, <em class="sig-param">event_labels=None</em>, <em class="sig-param">name=None</em>, <em class="sig-param">sim_params={}</em>, <em class="sig-param">real_baseline=None</em>, <em class="sig-param">real_response_coef=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulated pupil data for validation purposes.</p>
<dl class="method">
<dt id="pypillometry.pupildata.FakePupilData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">pupil</em>, <em class="sig-param">sampling_rate=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">event_onsets=None</em>, <em class="sig-param">event_labels=None</em>, <em class="sig-param">name=None</em>, <em class="sig-param">sim_params={}</em>, <em class="sig-param">real_baseline=None</em>, <em class="sig-param">real_response_coef=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.__init__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.FakePupilData.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">plot_range=(-inf</em>, <em class="sig-param">inf)</em>, <em class="sig-param">interactive=False</em>, <em class="sig-param">baseline=True</em>, <em class="sig-param">response=False</em>, <em class="sig-param">model=True</em>, <em class="sig-param">simulated=True</em>, <em class="sig-param">units='sec'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a plot of the pupil data using <cite>matplotlib</cite> or <a class="reference internal" href="#pypillometry.convenience.plot_pupil_ipy" title="pypillometry.convenience.plot_pupil_ipy"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.convenience.plot_pupil_ipy()</span></code></a>
if <cite>interactive=True</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_range</strong> (tuple (start,end): plot from start to end (in units of <cite>units</cite>)) – </p></li>
<li><p><strong>baseline</strong> (<em>plot baseline if estimated</em>) – </p></li>
<li><p><strong>response</strong> (<em>plot response if estimated</em>) – </p></li>
<li><p><strong>model</strong> (<em>plot full model if baseline and response have been estimated</em>) – </p></li>
<li><p><strong>simulated</strong> (<em>plot also the &quot;ground-truth&quot; baseline and response</em><em> (</em><em>i.e.</em><em>, </em><em>the simulated one</em><em>)</em><em>?</em>) – </p></li>
<li><p><strong>interactive</strong> (<em>if True</em><em>, </em><em>plot with sliders to adjust range</em>) – </p></li>
<li><p><strong>units</strong> (<em>one of &quot;sec&quot;=seconds</em><em>, </em><em>&quot;ms&quot;=millisec</em><em>, </em><em>&quot;min&quot;=minutes</em><em>, </em><em>&quot;h&quot;=hours</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.FakePupilData.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param">mean=None</em>, <em class="sig-param">sd=None</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the pupillary signal by subtracting <cite>mean</cite> and dividing by <cite>sd</cite>.
If these variables are not provided, use the signal’s mean and std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>mean to subtract from signal</em>) – </p></li>
<li><p><strong>sd</strong> (<em>sd to scale with</em>) – </p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scaling-parameters are being saved in the <cite>scale_params</cite> argument.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.FakePupilData.sub_slice">
<code class="sig-name descname">sub_slice</code><span class="sig-paren">(</span><em class="sig-param">start=-inf</em>, <em class="sig-param">end=inf</em>, <em class="sig-param">units='sec'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.sub_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <cite>PupilData</cite> object that is a shortened version
of the current one (contains all data between <cite>start</cite> and
<cite>end</cite> in units given by <cite>units</cite> (one of “ms”, “sec”, “min”, “h”).</p>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.FakePupilData.unscale">
<code class="sig-name descname">unscale</code><span class="sig-paren">(</span><em class="sig-param">mean=None</em>, <em class="sig-param">sd=None</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.FakePupilData.unscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale back to original values using either values provided as arguments
or the values stored in <cite>scale_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<em>mean to add from signal</em>) – </p></li>
<li><p><strong>sd</strong> (<em>sd to scale with</em>) – </p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pypillometry.pupildata.PupilData">
<em class="property">class </em><code class="sig-prename descclassname">pypillometry.pupildata.</code><code class="sig-name descname">PupilData</code><span class="sig-paren">(</span><em class="sig-param">pupil</em>, <em class="sig-param">sampling_rate=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">event_onsets=None</em>, <em class="sig-param">event_labels=None</em>, <em class="sig-param">name=None</em>, <em class="sig-param">keep_orig=True</em>, <em class="sig-param">fill_time_discontinuities=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class representing pupillometric data.</p>
<dl class="method">
<dt id="pypillometry.pupildata.PupilData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param">pupil</em>, <em class="sig-param">sampling_rate=None</em>, <em class="sig-param">time=None</em>, <em class="sig-param">event_onsets=None</em>, <em class="sig-param">event_labels=None</em>, <em class="sig-param">name=None</em>, <em class="sig-param">keep_orig=True</em>, <em class="sig-param">fill_time_discontinuities=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]) – name of the dataset or <cite>None</cite> (in which case a random string is selected)</p></li>
<li><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <code class="docutils literal notranslate"><span class="pre">None</span></code>]) – timing array or <cite>None</cite>, in which case the time-array goes from [0,maxT]
using <cite>sampling_rate</cite> (in ms)</p></li>
<li><p><strong>pupil</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>]]) – pupillary data at times <cite>time</cite> assumed to be in ms</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <code class="docutils literal notranslate"><span class="pre">None</span></code>]) – time-onsets of any events that are to be modelled in the pupil</p></li>
<li><p><strong>event_labels</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>], <code class="docutils literal notranslate"><span class="pre">None</span></code>]) – for each event in <cite>event_onsets</cite>, provide a label</p></li>
<li><p><strong>sampling_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling-rate of the pupillary signal in Hz</p></li>
<li><p><strong>keep_orig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – keep a copy of the original dataset? If <cite>True</cite>, a copy of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a> object
as initiated in the constructor is stored in member <cite>PupilData.original</cite></p></li>
<li><p><strong>fill_time_discontinuities</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – sometimes, when the eyetracker loses signal, no entry in the EDF is made;
when this option is True, such entries will be made and the signal set to 0 there</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.__len__">
<code class="sig-name descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__len__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of sampling points in the pupil data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.__repr__">
<code class="sig-name descname">__repr__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.__repr__" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string-representation of the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="pypillometry.pupildata.PupilData.__weakref__">
<code class="sig-name descname">__weakref__</code><a class="headerlink" href="#pypillometry.pupildata.PupilData.__weakref__" title="Permalink to this definition">¶</a></dt>
<dd><p>list of weak references to the object (if defined)</p>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.add_to_history">
<code class="sig-name descname">add_to_history</code><span class="sig-paren">(</span><em class="sig-param">event</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.add_to_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Add event to history</p>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.blinks_detect">
<code class="sig-name descname">blinks_detect</code><span class="sig-paren">(</span><em class="sig-param">min_duration=20</em>, <em class="sig-param">blink_val=0</em>, <em class="sig-param">winsize=11</em>, <em class="sig-param">vel_onset=-5</em>, <em class="sig-param">vel_offset=5</em>, <em class="sig-param">units='ms'</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect blinks in the pupillary signal using several strategies.
First, blinks are detected as consecutive sequence of <cite>blink_val</cite>
(f.eks., 0 or NaN). Second, blinks are defined as everything between
two crossings of the velocity profile (from negative to positive).</p>
<p>Detected blinks are put into member <cite>blinks</cite> (matrix 2 x nblinks where start and end
are stored as indexes) and member <cite>blink_mask</cite> which codes for each sampling point
whether there is a blink (1) or not (0).</p>
<p>Finally, detected blinks have to be at least <cite>min_duration</cite> duration (in <cite>units</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – minimum duration for a sequence of missing numbers to be treated as blink</p></li>
<li><p><strong>blink_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – “missing value” code</p></li>
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – window-size for smoothing for velocity profile (in units)</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – negative velocity that needs to be crossed; arbitrary units that depend on
sampling rate etc</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – positive velocity that needs to be exceeded; arbitrary units that depend on
sampling rate etc</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – one of “ms”, “sec”, “min”, “h”</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.blinks_interp_mahot">
<code class="sig-name descname">blinks_interp_mahot</code><span class="sig-paren">(</span><em class="sig-param">winsize=11</em>, <em class="sig-param">vel_onset=-5</em>, <em class="sig-param">vel_offset=5</em>, <em class="sig-param">margin=(10</em>, <em class="sig-param">30)</em>, <em class="sig-param">blinkwindow=500</em>, <em class="sig-param">interp_type='cubic'</em>, <em class="sig-param">plot=None</em>, <em class="sig-param">plot_dim=(5</em>, <em class="sig-param">3)</em>, <em class="sig-param">plot_figsize=(10</em>, <em class="sig-param">8)</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_interp_mahot" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the blink-interpolation method by Mahot (2013).</p>
<p>Mahot, 2013:
<a class="reference external" href="https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001">https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001</a>.</p>
<p>This procedure relies heavily on eye-balling (reconstructing visually convincing signal),
so a “plot” option is provided that will plot many diagnostics (see paper linked above) that
can help to set good parameter values for <cite>winsize</cite>, <cite>vel_onset</cite>, <cite>vel_offset</cite> and <cite>margin</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – size of the Hanning-window in ms</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – margin that is subtracted/added to onset and offset (in ms)</p></li>
<li><p><strong>blinkwindow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – how much time before and after each blink to include (in ms)</p></li>
<li><p><strong>interp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – type of interpolation accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d()</span></code></p></li>
<li><p><strong>plot</strong> (<em>True</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a>) – if a string, the plot is going to be saved to a multipage PDF file;
if None, no plotting is done
if True, plot is not saved but produced</p></li>
<li><p><strong>plot_dim</strong> (<em>tuple nrow x ncol</em>) – number of subplots</p></li>
<li><p><strong>plot_figsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><em>width</em><em>, </em><em>height</em><em>)</em>) – dimensions for each figure</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.blinks_interpolate">
<code class="sig-name descname">blinks_interpolate</code><span class="sig-paren">(</span><em class="sig-param">winsize=11</em>, <em class="sig-param">vel_onset=-5</em>, <em class="sig-param">vel_offset=5</em>, <em class="sig-param">margin=(10</em>, <em class="sig-param">30)</em>, <em class="sig-param">interp_type='cubic'</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolation of missing data “in one go”.
Detection of blinks happens using Mahot (2013), see <a class="reference internal" href="#pypillometry.preproc.blink_onsets_mahot" title="pypillometry.preproc.blink_onsets_mahot"><code class="xref py py-func docutils literal notranslate"><span class="pre">blink_onsets_mahot()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – size of the Hanning-window in ms</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – margin that is subtracted/added to onset and offset (in ms)</p></li>
<li><p><strong>interp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – type of interpolation accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">scipy.interpolate.interp1d()</span></code></p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.blinks_merge">
<code class="sig-name descname">blinks_merge</code><span class="sig-paren">(</span><em class="sig-param">distance=100</em>, <em class="sig-param">remove_signal=False</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge together blinks that are close together.
Some subjects blink repeatedly and standard detection/interpolation can result in weird results.
This function simply treats repeated blinks as one long blink.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – merge together blinks that are closer together than <cite>distance</cite> in ms</p></li>
<li><p><strong>remove_signal</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if True, set all signal values during the “new blinks” to zero so
that <code class="xref py py-func docutils literal notranslate"><span class="pre">detect_blinks()</span></code> will pick them up; interpolation will work
either way</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.blinks_plot">
<code class="sig-name descname">blinks_plot</code><span class="sig-paren">(</span><em class="sig-param">pdf_file=None</em>, <em class="sig-param">nrow=5</em>, <em class="sig-param">ncol=3</em>, <em class="sig-param">figsize=(10</em>, <em class="sig-param">10)</em>, <em class="sig-param">pre_blink=500</em>, <em class="sig-param">post_blink=500</em>, <em class="sig-param">units='ms'</em>, <em class="sig-param">plot_index=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.blinks_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the detected blinks into separate figures each with nrow x ncol subplots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdf_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a>) – if the name of a file is given, the figures are saved into a multi-page PDF file</p></li>
<li><p><strong>ncol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of columns for the blink-plots</p></li>
<li><p><strong>pre_blink</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – extend plot a certain time before each blink (in ms)</p></li>
<li><p><strong>post_blink</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – extend plot a certain time after each blink (in ms)</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – units in which the signal is plotted</p></li>
<li><p><strong>plot_index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – plot a number with the blinks’ index (e.g., for identifying abnormal blinks)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of plt.Figure objects each with nrow*ncol subplots</em></p></li>
<li><p><em>in Jupyter Notebook, those are displayed inline one after the other</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.copy">
<code class="sig-name descname">copy</code><span class="sig-paren">(</span><em class="sig-param">new_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Make and return a deep-copy of the pupil data.</p>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.downsample">
<code class="sig-name descname">downsample</code><span class="sig-paren">(</span><em class="sig-param">fsd</em>, <em class="sig-param">dsfac=False</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple downsampling scheme using mean within the downsampling window.
See <a class="reference internal" href="#pypillometry.baseline.downsample" title="pypillometry.baseline.downsample"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.downsample()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fsd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – new sampling-rate or decimate-factor</p></li>
<li><p><strong>dsfac</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – if False, <cite>fsd</cite> is the new sampling rate;
if True, <cite>fsd</cite> is the decimate factor</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.estimate_baseline">
<code class="sig-name descname">estimate_baseline</code><span class="sig-paren">(</span><em class="sig-param">method='envelope_iter_bspline_2'</em>, <em class="sig-param">inplace=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.estimate_baseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply one of the baseline-estimation methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – <dl class="simple">
<dt>“envelope_iter_bspline_1”: <a class="reference internal" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="pypillometry.baseline.baseline_envelope_iter_bspline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.baseline_envelope_iter_bspline()</span></code></a></dt><dd><p>with one iteration</p>
</dd>
<dt>”envelope_iter_bspline_2”: <a class="reference internal" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="pypillometry.baseline.baseline_envelope_iter_bspline"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.baseline_envelope_iter_bspline()</span></code></a></dt><dd><p>with two iterations</p>
</dd>
</dl>
</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
<li><p><strong>kwargs</strong> – named arguments passed to the low-level function in <a class="reference internal" href="#module-pypillometry.baseline" title="pypillometry.baseline"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pypillometry.baseline</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the results of the estimation is stored in member <cite>baseline</cite></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.estimate_response">
<code class="sig-name descname">estimate_response</code><span class="sig-paren">(</span><em class="sig-param">npar='free'</em>, <em class="sig-param">tmax='free'</em>, <em class="sig-param">verbose=50</em>, <em class="sig-param">bounds={'npar': (1</em>, <em class="sig-param">20)</em>, <em class="sig-param">'tmax': (100</em>, <em class="sig-param">2000)}</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.estimate_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate pupil-response based on event-onsets, see
<a class="reference internal" href="#pypillometry.pupil.pupil_response" title="pypillometry.pupil.pupil_response"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_response()</span></code></a>.</p>
<dl class="simple">
<dt>npar: float</dt><dd><p>npar-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>tmax: float</dt><dd><p>tmax-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>bounds: dict</dt><dd><p>in case that one or both parameters are estimated, give the lower
and upper bounds for the parameters</p>
</dd>
<dt>inplace: bool</dt><dd><p>if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>the results of the estimation is stored in members <cite>response</cite>, <cite>response_x</cite> (design matrix)
and <cite>response_pars</cite></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.from_file">
<em class="property">classmethod </em><code class="sig-name descname">from_file</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a> object from a pickle-file.
Use as <code class="docutils literal notranslate"><span class="pre">pypillometry.PupilData.from_file(&quot;yourfile.pd&quot;)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.get_erpd">
<code class="sig-name descname">get_erpd</code><span class="sig-paren">(</span><em class="sig-param">erpd_name</em>, <em class="sig-param">event_select</em>, <em class="sig-param">baseline_win=None</em>, <em class="sig-param">time_win=(-500</em>, <em class="sig-param">2000)</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.get_erpd" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract event-related pupil dilation (ERPD).
No attempt is being made to exclude overlaps of the time-windows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>erpd_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – identifier for the result (e.g., “cue-locked” or “conflict-trials”)</p></li>
<li><p><strong>baseline_win</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>) or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a>) – <p>if None, no baseline-correction is applied
if tuple, the mean value in the window in milliseconds (relative to <cite>time_win</cite>) is</p>
<blockquote>
<div><p>subtracted from the single-trial ERPDs (baseline-correction)</p>
</div></blockquote>
</p></li>
<li><p><strong>event_select</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>function</em>) – variable describing which events to select and align to
- if str: use all events whose label contains the string
- if function: apply function to all labels, use those where the function returns True</p></li>
<li><p><strong>time_win</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – time before and after event to include (in ms)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.lowpass_filter">
<code class="sig-name descname">lowpass_filter</code><span class="sig-paren">(</span><em class="sig-param">cutoff</em>, <em class="sig-param">order=2</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.lowpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowpass-filter signal using a Butterworth-filter,
see <a class="reference internal" href="#pypillometry.baseline.butter_lowpass_filter" title="pypillometry.baseline.butter_lowpass_filter"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.baseline.butter_lowpass_filter()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – filter order</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.nblinks">
<code class="sig-name descname">nblinks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.nblinks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of detected blinks. Should be run after <cite>detect_blinks()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.nevents">
<code class="sig-name descname">nevents</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.nevents" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of events in pupillometric data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">plot_range=(-inf</em>, <em class="sig-param">inf)</em>, <em class="sig-param">interactive=False</em>, <em class="sig-param">baseline=True</em>, <em class="sig-param">response=False</em>, <em class="sig-param">model=True</em>, <em class="sig-param">highlight_blinks=True</em>, <em class="sig-param">highlight_interpolated=True</em>, <em class="sig-param">units='sec'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a plot of the pupil data using <cite>matplotlib</cite> or <a class="reference internal" href="#pypillometry.convenience.plot_pupil_ipy" title="pypillometry.convenience.plot_pupil_ipy"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.convenience.plot_pupil_ipy()</span></code></a>
if <cite>interactive=True</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plot_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><em>start</em><em>,</em><em>end</em><em>)</em>) – plot from start to end (in units of <cite>units</cite>)</p></li>
<li><p><strong>baseline</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – plot baseline if estimated</p></li>
<li><p><strong>response</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – plot response if estimated</p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – plot full model if baseline and response have been estimated</p></li>
<li><p><strong>interactive</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if True, plot with sliders to adjust range</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – one of “sec”=seconds, “ms”=millisec, “min”=minutes, “h”=hours</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.plot_segments">
<code class="sig-name descname">plot_segments</code><span class="sig-paren">(</span><em class="sig-param">overlay=None</em>, <em class="sig-param">pdffile=None</em>, <em class="sig-param">interv=1</em>, <em class="sig-param">figsize=(15</em>, <em class="sig-param">5)</em>, <em class="sig-param">ylim=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.plot_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the whole dataset chunked up into segments (usually to a PDF file).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdffile</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a>) – file name to store the PDF; if None, no PDF is written</p></li>
<li><p><strong>interv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – duration of each of the segments to be plotted (in minutes)</p></li>
<li><p><strong>figsize</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – dimensions of the figures</p></li>
<li><p><strong>kwargs</strong> – arguments passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">PupilData.plot()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>figs</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.Figure</span></code> objects</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.print_history">
<code class="sig-name descname">print_history</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.print_history" title="Permalink to this definition">¶</a></dt>
<dd><p>Pretty-print the history of the current dataset (which manipulations where done on it).</p>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.reset_time">
<code class="sig-name descname">reset_time</code><span class="sig-paren">(</span><em class="sig-param">t0=0</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.reset_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets time so that the time-array starts at time zero (t0).
Resets onsets etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – time at which the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>’s time-vector starts</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param">mean=None</em>, <em class="sig-param">sd=None</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the pupillary signal by subtracting <cite>mean</cite> and dividing by <cite>sd</cite>.
If these variables are not provided, use the signal’s mean and std.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – mean to subtract from signal</p></li>
<li><p><strong>sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sd to scale with</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Scaling-parameters are being saved in the <cite>scale_params</cite> argument.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.smooth_window">
<code class="sig-name descname">smooth_window</code><span class="sig-paren">(</span><em class="sig-param">window='hanning'</em>, <em class="sig-param">winsize=11</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.smooth_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply smoothing of the signal using a moving window. See <a class="reference internal" href="#pypillometry.preproc.smooth_window" title="pypillometry.preproc.smooth_window"><code class="xref py py-func docutils literal notranslate"><span class="pre">smooth_window()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <dl class="simple">
<dt>(the type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’, ‘blackman’);</dt><dd><p>flat window will produce a moving average smoothing.</p>
</dd>
</dl>
</p></li>
<li><p><strong>winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the length of the window in ms</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.stat_per_event">
<code class="sig-name descname">stat_per_event</code><span class="sig-paren">(</span><em class="sig-param">interval</em>, <em class="sig-param">statfct=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.stat_per_event" title="Permalink to this definition">¶</a></dt>
<dd><p>Return result of applying a statistical function to pupillometric data in a
given interval relative to event-onsets. For example, extract mean
pupil-size in interval before trial onset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><em>min</em><em>,</em><em>max</em><em>)</em>) – time-window in ms relative to event-onset (0 is event-onset)</p></li>
<li><p><strong>statfct</strong> (<em>function</em>) – function mapping np.array to a single number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – number of event-onsets long result array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.sub_slice">
<code class="sig-name descname">sub_slice</code><span class="sig-paren">(</span><em class="sig-param">start=-inf</em>, <em class="sig-param">end=inf</em>, <em class="sig-param">units='sec'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.sub_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new <cite>PupilData</cite> object that is a shortened version
of the current one (contains all data between <cite>start</cite> and
<cite>end</cite> in units given by <cite>units</cite> (one of “ms”, “sec”, “min”, “h”).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – start for new dataset</p></li>
<li><p><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – end of new dataset</p></li>
<li><p><strong>units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – time units in which <cite>start</cite> and <cite>end</cite> are provided</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a summary of the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.unscale">
<code class="sig-name descname">unscale</code><span class="sig-paren">(</span><em class="sig-param">mean=None</em>, <em class="sig-param">sd=None</em>, <em class="sig-param">inplace=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.unscale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale back to original values using either values provided as arguments
or the values stored in <cite>scale_params</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – mean to add from signal</p></li>
<li><p><strong>sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sd to scale with</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if <cite>True</cite>, make change in-place and return the object
if <cite>False</cite>, make and return copy before making changes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="pypillometry.pupildata.PupilData.write_file">
<code class="sig-name descname">write_file</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.PupilData.write_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Save to file (using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – filename</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pypillometry.pupildata.create_fake_pupildata">
<code class="sig-prename descclassname">pypillometry.pupildata.</code><code class="sig-name descname">create_fake_pupildata</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.create_fake_pupildata" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="xref py py-class docutils literal notranslate"><span class="pre">pyillometry.pupildata.FakePupilData</span></code> object by buildling it with
<a class="reference internal" href="#pypillometry.fakedata.get_dataset" title="pypillometry.fakedata.get_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.fakedata.get_dataset()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ntrials</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of trials</p></li>
<li><p><strong>isi</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – inter-stimulus interval in seconds</p></li>
<li><p><strong>rtdist</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – mean and std of a (truncated at zero) normal distribution to generate response times</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – padding before the first and after the last event in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>baseline_lowpass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – cutoff for the lowpass-filter that defines the baseline
(highest allowed frequency in the baseline fluctuations)</p></li>
<li><p><strong>evoked_response_perc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – amplitude of the pupil-response as proportion of the baseline</p></li>
<li><p><strong>response_fluct_sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – How much do the amplitudes of the individual events fluctuate?
This is determined by drawing each individual pupil-response to
a single event from a (positive) normal distribution with mean as determined
by <cite>evoked_response_perc</cite> and sd <cite>response_fluct_sd</cite> (in units of
<cite>evoked_response_perc</cite>).</p></li>
<li><p><strong>prf_npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – (mean,std) of the npar parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, npar is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>prf_tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – (mean,std) of the tmax parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, tmax is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>prop_spurious_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Add random events to the pupil signal. <cite>prop_spurious_events</cite> is expressed
as proportion of the number of real events.</p></li>
<li><p><strong>noise_amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Amplitude of random gaussian noise that sits on top of the simulated signal.
Expressed in units of mean baseline pupil diameter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupildata.plotpd">
<code class="sig-prename descclassname">pypillometry.pupildata.</code><code class="sig-name descname">plotpd</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">subplots=False</em>, <em class="sig-param">baseline=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.plotpd" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting for <cite>PupilData</cite> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subplots</strong> (plot the different <cite>PupilData</cite>-objects in the same plot or subplots) – </p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupildata.plotpd_ia">
<code class="sig-prename descclassname">pypillometry.pupildata.</code><code class="sig-name descname">plotpd_ia</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">figsize=(16</em>, <em class="sig-param">8)</em>, <em class="sig-param">baseline=True</em>, <em class="sig-param">events=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupildata.plotpd_ia" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactive plotting for multiple <cite>PupilData</cite> objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<cite>PupilData</cite> datasets to plot) – </p></li>
<li><p><strong>figsize</strong> (<em>dimensions of the plot</em>) – </p></li>
<li><p><strong>baseline</strong> (<em>plot baselines</em><em>, </em><em>too?</em>) – </p></li>
<li><p><strong>events</strong> (plot event-markers? if None, no events are plotted, otherwise <cite>events</cite>) – is the index of the <cite>PupilData</cite> object to take the events from</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.io"></span><div class="section" id="io-py">
<h2>io.py<a class="headerlink" href="#io-py" title="Permalink to this headline">¶</a></h2>
<p>Read/Write data from/to disk.</p>
<dl class="function">
<dt id="pypillometry.io.pd_read_pickle">
<code class="sig-prename descclassname">pypillometry.io.</code><code class="sig-name descname">pd_read_pickle</code><span class="sig-paren">(</span><em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.io.pd_read_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object <cite>pdobj</cite> from file using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – filename or URL to load data from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pdobj</strong> – loaded dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.io.pd_write_pickle">
<code class="sig-prename descclassname">pypillometry.io.</code><code class="sig-name descname">pd_write_pickle</code><span class="sig-paren">(</span><em class="sig-param">pdobj</em>, <em class="sig-param">fname</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.io.pd_write_pickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the <a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>-object <cite>pdobj</cite> in file using <a class="reference external" href="https://docs.python.org/3/library/pickle.html#module-pickle" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pickle</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pdobj</strong> (<a class="reference internal" href="#pypillometry.pupildata.PupilData" title="pypillometry.pupildata.PupilData"><code class="xref py py-class docutils literal notranslate"><span class="pre">PupilData</span></code></a>) – dataset to save</p></li>
<li><p><strong>fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – filename to save to</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.preproc"></span><div class="section" id="preproc-py">
<h2>preproc.py<a class="headerlink" href="#preproc-py" title="Permalink to this headline">¶</a></h2>
<p>preprocessing functions (blinks, smoothing, missing data…)</p>
<dl class="function">
<dt id="pypillometry.preproc.blink_onsets_mahot">
<code class="sig-prename descclassname">pypillometry.preproc.</code><code class="sig-name descname">blink_onsets_mahot</code><span class="sig-paren">(</span><em class="sig-param">sy</em>, <em class="sig-param">blinks</em>, <em class="sig-param">smooth_winsize</em>, <em class="sig-param">vel_onset</em>, <em class="sig-param">vel_offset</em>, <em class="sig-param">margin</em>, <em class="sig-param">blinkwindow</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.blink_onsets_mahot" title="Permalink to this definition">¶</a></dt>
<dd><p>Method for finding the on- and offset for each blink (excluding transient).
See <a class="reference external" href="https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001">https://figshare.com/articles/A_simple_way_to_reconstruct_pupil_size_during_eye_blinks/688001</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em>) – pupil data</p></li>
<li><p><strong>blinks</strong> (<em>np.array</em><em> (</em><em>nblinks x 2</em><em>)</em>) – blink onset/offset matrix (contiguous zeros)</p></li>
<li><p><strong>smooth_winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>odd</em><em>)</em>) – size of the Hanning-window in sampling points</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
<li><p><strong>margin</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em>) – margin that is subtracted/added to onset and offset (in sampling points)</p></li>
<li><p><strong>blinkwindow</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – how much time before and after each blink to include (in sampling points)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.preproc.detect_blinks_velocity">
<code class="sig-prename descclassname">pypillometry.preproc.</code><code class="sig-name descname">detect_blinks_velocity</code><span class="sig-paren">(</span><em class="sig-param">sy</em>, <em class="sig-param">smooth_winsize</em>, <em class="sig-param">vel_onset</em>, <em class="sig-param">vel_offset</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.detect_blinks_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect blinks as everything between a fast downward and a fast upward-trending PD-changes.</p>
<p>This works similarly to <a class="reference internal" href="#pypillometry.preproc.blink_onsets_mahot" title="pypillometry.preproc.blink_onsets_mahot"><code class="xref py py-func docutils literal notranslate"><span class="pre">blink_onsets_mahot()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em>) – pupil data</p></li>
<li><p><strong>smooth_winsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> (</em><em>odd</em><em>)</em>) – size of the Hanning-window in sampling points</p></li>
<li><p><strong>vel_onset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the onset of the blink</p></li>
<li><p><strong>vel_offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – velocity-threshold to detect the offset of the blink</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.preproc.detect_blinks_zero">
<code class="sig-prename descclassname">pypillometry.preproc.</code><code class="sig-name descname">detect_blinks_zero</code><span class="sig-paren">(</span><em class="sig-param">sy</em>, <em class="sig-param">min_duration</em>, <em class="sig-param">blink_val=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.detect_blinks_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect blinks as consecutive sequence of <cite>blink_val</cite> (f.eks., 0 or NaN) of at least
<cite>min_duration</cite> successive values in the signal <cite>sy</cite>.
Detected blinks are put a matrix <cite>blinks</cite> (nblinks x 2) where start and end
are stored as indexes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sy</strong> (<em>np.array</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – signal</p></li>
<li><p><strong>min_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – minimum number of consecutive samples for a sequence of missing numbers to be treated as blink</p></li>
<li><p><strong>blink_val</strong> – “missing value” code</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array (nblinks x 2) containing the indices of the start/end of the blinks</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.preproc.smooth_window">
<code class="sig-prename descclassname">pypillometry.preproc.</code><code class="sig-name descname">smooth_window</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">window_len=11</em>, <em class="sig-param">window='hanning'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.preproc.smooth_window" title="Permalink to this definition">¶</a></dt>
<dd><p>smooth the data using a window with requested size.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal
(with the window size) in both ends so that transient parts are minimized
in the begining and end part of the output signal.</p>
<p>adapted from SciPy Cookbook: <a class="reference external" href="https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html">https://scipy-cookbook.readthedocs.io/items/SignalSmooth.html</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>the input signal</em>) – </p></li>
<li><p><strong>window_len</strong> (<em>the dimension of the smoothing window; should be an odd integer</em>) – </p></li>
<li><p><strong>window</strong> (<em>the type of window from 'flat'</em><em>, </em><em>'hanning'</em><em>, </em><em>'hamming'</em><em>, </em><em>'bartlett'</em><em>, </em><em>'blackman'</em>) – flat window will produce a moving average smoothing.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>np.array</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>the smoothed signal</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.fakedata"></span><div class="section" id="fakedata-py">
<h2>fakedata.py<a class="headerlink" href="#fakedata-py" title="Permalink to this headline">¶</a></h2>
<p>Generate artificial pupil-data.</p>
<dl class="function">
<dt id="pypillometry.fakedata.generate_pupil_data">
<code class="sig-prename descclassname">pypillometry.fakedata.</code><code class="sig-name descname">generate_pupil_data</code><span class="sig-paren">(</span><em class="sig-param">event_onsets</em>, <em class="sig-param">fs=1000</em>, <em class="sig-param">pad=5000</em>, <em class="sig-param">baseline_lowpass=0.2</em>, <em class="sig-param">evoked_response_perc=0.02</em>, <em class="sig-param">response_fluct_sd=1</em>, <em class="sig-param">prf_npar=(10.35</em>, <em class="sig-param">0)</em>, <em class="sig-param">prf_tmax=(917.0</em>, <em class="sig-param">0)</em>, <em class="sig-param">prop_spurious_events=0.2</em>, <em class="sig-param">noise_amp=0.0005</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.fakedata.generate_pupil_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate artificial pupil data as a sum of slow baseline-fluctuations
on which event-evoked responses are “riding”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – list of all events that evoke a response (in seconds)</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>pad</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – append <cite>pad</cite> milliseconds of signal after the last event is decayed</p></li>
<li><p><strong>baseline_lowpass</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – cutoff for the lowpass-filter that defines the baseline
(highest allowed frequency in the baseline fluctuations)</p></li>
<li><p><strong>evoked_response_perc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – amplitude of the pupil-response as proportion of the baseline</p></li>
<li><p><strong>response_fluct_sd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – How much do the amplitudes of the individual events fluctuate?
This is determined by drawing each individual pupil-response to
a single event from a (positive) normal distribution with mean as determined
by <cite>evoked_response_perc</cite> and sd <cite>response_fluct_sd</cite> (in units of
<cite>evoked_response_perc</cite>).</p></li>
<li><p><strong>prf_npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – (mean,std) of the npar parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, npar is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>prf_tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>,</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>)</em>) – (mean,std) of the tmax parameter from <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a>.
If the std is exactly zero, then the mean is used for all pupil-responses.
If the std is positive, tmax is taken i.i.d. from ~ normal(mean,std) for each event.</p></li>
<li><p><strong>prop_spurious_events</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Add random events to the pupil signal. <cite>prop_spurious_events</cite> is expressed
as proportion of the number of real events.</p></li>
<li><p><strong>noise_amp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Amplitude of random gaussian noise that sits on top of the simulated signal.
Expressed in units of mean baseline pupil diameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tx, sy</strong> (<em>np.array</em>) – time and simulated pupil-dilation (n)</p></li>
<li><p><strong>x0</strong> (<em>np.array</em>) – baseline (n)</p></li>
<li><p><strong>delta_weights</strong> (<em>np.array</em>) – pupil-response strengths (len(event_onsets))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.fakedata.get_dataset">
<code class="sig-prename descclassname">pypillometry.fakedata.</code><code class="sig-name descname">get_dataset</code><span class="sig-paren">(</span><em class="sig-param">ntrials=100</em>, <em class="sig-param">isi=2000</em>, <em class="sig-param">rtdist=(1000</em>, <em class="sig-param">500)</em>, <em class="sig-param">fs=1000</em>, <em class="sig-param">pad=5000</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.fakedata.get_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function to run <a class="reference internal" href="#pypillometry.fakedata.generate_pupil_data" title="pypillometry.fakedata.generate_pupil_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_pupil_data()</span></code></a> with standard parameters.
:param ntrials: number of trials
:type ntrials: int
:param isi: inter-stimulus interval in milliseconds
:type isi: float
:param rtdist: mean and std of a (truncated at zero) normal distribution to generate response times
:type rtdist: tuple (float,float)
:param fs: sampling rate
:type fs: float
:param pad: padding before the first and after the last event in seconds
:type pad: float
:param kwargs: arguments for <a class="reference internal" href="#pypillometry.fakedata.generate_pupil_data" title="pypillometry.fakedata.generate_pupil_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.fakedata.generate_pupil_data()</span></code></a>
:type kwargs: dict</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>tx, sy</strong> (<em>np.array</em>) – time and simulated pupil-dilation (n)</p></li>
<li><p><strong>baseline</strong> (<em>np.array</em>) – baseline (n)</p></li>
<li><p><strong>event_onsets</strong> (<em>np.array</em>) – timing of the simulated event-onsets (stimuli and responses not separated)</p></li>
<li><p><strong>response_coef</strong> (<em>np.array</em>) – pupil-response strengths (len(event_onsets))</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.baseline"></span><div class="section" id="baseline-py">
<h2>baseline.py<a class="headerlink" href="#baseline-py" title="Permalink to this headline">¶</a></h2>
<p>Functions for estimating tonic pupillary fluctuations (baseline).</p>
<dl class="function">
<dt id="pypillometry.baseline.baseline_envelope">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">baseline_envelope</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs=1000</em>, <em class="sig-param">lp=2</em>, <em class="sig-param">prominence_thr=80</em>, <em class="sig-param">interp_method='cubic'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_envelope" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract baseline based on the lower envelope of the (filtered) signal.</p>
<p>Steps:</p>
<ul class="simple">
<li><p>filter away noise</p></li>
<li><p>detect high-prominence throughs in the signal</p></li>
<li><p>calculate lower envelope based on these peaks</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>lp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – low-pass filter cutoff for removing random noise</p></li>
<li><p><strong>prominence_thr</strong> (<em>float in</em><em> [</em><em>0</em><em>,</em><em>100</em><em>]</em>) – percentile of the prominence distribution (of the peaks) to
use for determining prominent peaks (see <cite>scipy.stats.peak_prominences()</cite>)</p></li>
<li><p><strong>interp_method</strong> (<em>string</em><em>, </em><em>one of</em><em> [</em><em>&quot;linear&quot;</em><em>, </em><em>&quot;cubic&quot;</em><em>, </em><em>&quot;spline&quot;</em><em>]</em>) – <p>“linear” - linear interpolation between the high-prominence peaks
“cubic”  - cubic interpolation through all high-prominence peaks
“spline” - a smoothing spline that is guaranteed to go through all</p>
<blockquote>
<div><p>high-prominence peaks and smoothes through all the other
(lower-prominence) peaks</p>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>base</strong> – baseline estimate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.baseline_envelope_iter_bspline">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">baseline_envelope_iter_bspline</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs</em>, <em class="sig-param">fsd=10</em>, <em class="sig-param">lp=2</em>, <em class="sig-param">lam_sig=1</em>, <em class="sig-param">lam_min=1</em>, <em class="sig-param">lam_max=100</em>, <em class="sig-param">verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_envelope_iter_bspline" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract baseline based (re-)estimating the lower envelope using B-splines.
See notebook <cite>baseline_interp.ipynb</cite> for details.
The signal is downsampled (to <cite>fsd</cite> Hz) for speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in milliseconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>fsd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – downsampled sampling rate (if too slow, decrease)</p></li>
<li><p><strong>lp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – lowpass-filter cutoff (Hz)</p></li>
<li><p><strong>lam_sig</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter steering how much the baseline is shaped by the non-peaks of the signal</p></li>
<li><p><strong>lam_min</strong><strong>,</strong><strong>lam_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameters mapping how much low- and high-prominence peaks influence the baseline</p></li>
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> [</em><em>0</em><em>, </em><em>100</em><em>]</em>) – how much information to print (0 nothing, 100 everything)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>(txd,syd,base2,base1)</strong> – txd: downsampled time-array
syd: downsampled and lowpass-filtered pupil signal
base1: is the estimated base after the first round
base2: is the final baseline estimate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.baseline_pupil_model">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">baseline_pupil_model</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs=1000</em>, <em class="sig-param">lp1=2</em>, <em class="sig-param">lp2=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.baseline_pupil_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract baseline based on filtering after removing stim-locked activity.</p>
<p>Steps:</p>
<ul class="simple">
<li><p>filter away noise</p></li>
<li><p>regress out event-locked activity from the filtered signal using NNLS</p></li>
<li><p>remove modeled signal from filtered data</p></li>
<li><p>run another lowpass-filter to get rid of spurious signals</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>lp1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – low-pass filter cutoff for removing random noise</p></li>
<li><p><strong>lp2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – low-pass filter cutoff for removing spurious peaks from the baseline-signal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>base</strong> – baseline estimate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.bspline">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">bspline</code><span class="sig-paren">(</span><em class="sig-param">txd</em>, <em class="sig-param">knots</em>, <em class="sig-param">spline_degree=3</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.bspline" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-implementation from <a class="reference external" href="https://mc-stan.org/users/documentation/case-studies/splines_in_stan.html">https://mc-stan.org/users/documentation/case-studies/splines_in_stan.html</a>.
Similar behaviour as R’s bs() function from the splines-library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>txd</strong> (<em>np.array</em>) – time-vector</p></li>
<li><p><strong>knots</strong> (<em>np.array</em>) – location of the knots</p></li>
<li><p><strong>spline_degree</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – degree of the spline</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>B</strong> – matrix of basis functions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.butter_lowpass">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">butter_lowpass</code><span class="sig-paren">(</span><em class="sig-param">cutoff</em>, <em class="sig-param">fs</em>, <em class="sig-param">order=5</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.butter_lowpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Get lowpass-filter coefficients for Butterworth-filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – filter order</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>(b,a)</strong> – filter coefficients</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a>,<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.butter_lowpass_filter">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">butter_lowpass_filter</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">cutoff</em>, <em class="sig-param">fs</em>, <em class="sig-param">order=5</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.butter_lowpass_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowpass-filter signal using a Butterworth-filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>np.array</em>) – data to lowpass-filter</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – lowpass-filter cutoff</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – filter order</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> – filtered data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.baseline.downsample">
<code class="sig-prename descclassname">pypillometry.baseline.</code><code class="sig-name descname">downsample</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">R</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.baseline.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple downsampling scheme using mean within the downsampling window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>np.array</em>) – signal to downsample</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – decimate-factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> – downsampled data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.pupil"></span><div class="section" id="pupil-py">
<h2>pupil.py<a class="headerlink" href="#pupil-py" title="Permalink to this headline">¶</a></h2>
<p>functions related to pupillary responses.</p>
<dl class="function">
<dt id="pypillometry.pupil.plot_prf">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">plot_prf</code><span class="sig-paren">(</span><em class="sig-param">npar=10.1</em>, <em class="sig-param">tmax=930</em>, <em class="sig-param">max_duration='estimate'</em>, <em class="sig-param">fs=500</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.plot_prf" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot profile of the pupil-response function (PRF) with
parameters <cite>npar</cite> and <cite>tmax</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupil_build_design_matrix">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupil_build_design_matrix</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs</em>, <em class="sig-param">npar</em>, <em class="sig-param">tmax</em>, <em class="sig-param">max_duration='estimate'</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_build_design_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct design matrix (nevents x n).
Each column has a single pupil-kernel with parameters <cite>npar</cite>, <cite>tmax</cite> starting at
each <cite>event_onset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.array</em>) – in ms</p></li>
<li><p><strong>event_onsets</strong> (<em>np.array</em>) – timing of the events</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate (Hz)</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – n in the equation of <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – t_{max} in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
<li><p><strong>max_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> or </em><em>&quot;estimate&quot;</em>) – either maximum duration in milliseconds or string “estimate” which
causes the function to determine an appropriate duration based on the
kernel parameters <cite>npar</cite> and <cite>tmax</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x1</strong> – design matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array (nevents x n)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupil_get_max_duration">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupil_get_max_duration</code><span class="sig-paren">(</span><em class="sig-param">npar</em>, <em class="sig-param">tmax</em>, <em class="sig-param">thr=1e-08</em>, <em class="sig-param">stepsize=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_get_max_duration" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the time when the PRF with parameters <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(t_{max}\)</span> is decayed to
<cite>thr</cite>. This gives an indication of how long the <cite>duration</cite> parameter
in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a> should be chosen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>npar</strong><strong>,</strong><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – PRF parameters, see <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a></p></li>
<li><p><strong>thr</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – desired value to which the PRF is decayed (the lower <cite>thr</cite>, the longer the duration)</p></li>
<li><p><strong>stepsize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – precision of the maximum duration in ms</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tdur</strong> – first value of t so that PRF(t)&lt;<cite>thr</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupil_kernel">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupil_kernel</code><span class="sig-paren">(</span><em class="sig-param">duration=4000</em>, <em class="sig-param">fs=1000</em>, <em class="sig-param">npar=10.1</em>, <em class="sig-param">tmax=930.0</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>According to Hoeks and Levelt (1993,
<a class="reference external" href="https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf">https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf</a>),
the PRF can be described by the so-called Erlang gamma function
$$h_{HL}(t) = t^n e^{-nt/t_{max}}$$
which we normalize to
$$h(t)=\frac{1}{h_{max}} h_{HL}(t)$$
where $$h_{max} = \max_t{\left(h_{HL}(t)\right)} = e^{-n}t_{max}^{n}$$
which yields a maximum value of 1 for this function.
The function <span class="math notranslate nohighlight">\(h(t)\)</span> is implemented in <cite>pp.pupil_kernel()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – in ms; maximum of the time window for which to calculate the PRF [0,duration]</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate for resolving the PRF</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – n in the equation above</p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – t_{max} in the equation above</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>h</strong> – sampled version of h(t) over the interval [0,`duration`] with sampling rate <cite>fs</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupil_kernel_t">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupil_kernel_t</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">npar</em>, <em class="sig-param">tmax</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_kernel_t" title="Permalink to this definition">¶</a></dt>
<dd><p>According to Hoeks and Levelt (1993,
<a class="reference external" href="https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf">https://link.springer.com/content/pdf/10.3758%2FBF03204445.pdf</a>),
the PRF can be described by the so-called Erlang gamma function
$$h_{HL}(t) = t^n e^{-nt/t_{max}}$$
which we normalize to
$$h(t)=\frac{1}{h_{max}} h_{HL}(t)$$
where $$h_{max} = \max_t{\left(h_{HL}(t)\right)} = e^{-n}t_{max}^{n}$$
which yields a maximum value of 1 for this function.
The function <span class="math notranslate nohighlight">\(h(t)\)</span> is implemented in <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pupil_kernel()</span></code></a>.</p>
<p>This version of the function evaluates the PRF at inputs <cite>t</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float/np.array</em>) – in ms</p></li>
<li><p><strong>npar</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – n in the equation above</p></li>
<li><p><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – t_{max} in the equation above</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>h</strong> – PRF evaluated at <cite>t</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupil_response">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupil_response</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs</em>, <em class="sig-param">npar='free'</em>, <em class="sig-param">tmax='free'</em>, <em class="sig-param">verbose=10</em>, <em class="sig-param">bounds={'npar': (1</em>, <em class="sig-param">20)</em>, <em class="sig-param">'tmax': (100</em>, <em class="sig-param">2000)}</em>, <em class="sig-param">display_progress=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupil_response" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate pupil-response based on event-onsets.</p>
<dl class="simple">
<dt>tx<span class="classifier">np.ndarray</span></dt><dd><p>time-vector in milliseconds</p>
</dd>
<dt>sy<span class="classifier">np.ndarray</span></dt><dd><p>(baseline-corrected) pupil signal</p>
</dd>
<dt>event_onsets<span class="classifier">list</span></dt><dd><p>onsets of events (stimuli/responses) in milliseconds</p>
</dd>
<dt>fs<span class="classifier">float</span></dt><dd><p>sampling rate in Hz</p>
</dd>
<dt>npar: float</dt><dd><p>npar-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>tmax: float</dt><dd><p>tmax-parameter for the canonical response-function or “free”;
in case of “free”, the function optimizes for this parameter</p>
</dd>
<dt>bounds: dict</dt><dd><p>in case that one or both parameters are estimated, give the lower
and upper bounds for the parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.pupilresponse_nnls">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">pupilresponse_nnls</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">fs</em>, <em class="sig-param">npar=10.1</em>, <em class="sig-param">tmax=930</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.pupilresponse_nnls" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate single-event pupil responses based on canonical PRF (<cite>pupil_kernel()</cite>)
using non-negative least-squares (NNLS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in milliseconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – (baseline-corrected) pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>fs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – sampling rate in Hz</p></li>
<li><p><strong>npar</strong><strong>,</strong><strong>tmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameters for <a class="reference internal" href="#pypillometry.pupil.pupil_kernel" title="pypillometry.pupil.pupil_kernel"><code class="xref py py-func docutils literal notranslate"><span class="pre">pypillometry.pupil.pupil_kernel()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>(coef,pred,resid)</strong> – coef: purely-positive regression coefficients
pred: predicted signal
resid: residuals (sy-pred)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.pupil.stat_event_interval">
<code class="sig-prename descclassname">pypillometry.pupil.</code><code class="sig-name descname">stat_event_interval</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets</em>, <em class="sig-param">interval</em>, <em class="sig-param">statfct=&lt;function mean&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.pupil.stat_event_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Return result of applying a statistical function to pupillometric data in a
given interval relative to event-onsets. For example, extract mean
pupil-size in interval before trial onset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in milliseconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – (baseline-corrected) pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em> (</em><em>min</em><em>,</em><em>max</em><em>)</em>) – time-window in ms relative to event-onset (0 is event-onset)</p></li>
<li><p><strong>statfct</strong> (<em>function</em>) – function mapping np.array to a single number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – number of event-onsets long result array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</div>
<span class="target" id="module-pypillometry.convenience"></span><div class="section" id="convenience-py">
<h2>convenience.py<a class="headerlink" href="#convenience-py" title="Permalink to this headline">¶</a></h2>
<p>Some convenience functions.</p>
<dl class="function">
<dt id="pypillometry.convenience.StanModel_cache">
<code class="sig-prename descclassname">pypillometry.convenience.</code><code class="sig-name descname">StanModel_cache</code><span class="sig-paren">(</span><em class="sig-param">model_code</em>, <em class="sig-param">model_name=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.StanModel_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Use just as you would <cite>stan</cite></p>
</dd></dl>

<dl class="function">
<dt id="pypillometry.convenience.p_asym_laplac">
<code class="sig-prename descclassname">pypillometry.convenience.</code><code class="sig-name descname">p_asym_laplac</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">mu</em>, <em class="sig-param">sigma</em>, <em class="sig-param">tau</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.p_asym_laplac" title="Permalink to this definition">¶</a></dt>
<dd><p>Asymmetric laplace distribution <a class="reference external" href="https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution">https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution</a>;
Parametrization as here: <a class="reference external" href="https://github.com/stan-dev/stan/issues/2312">https://github.com/stan-dev/stan/issues/2312</a></p>
<p>tau in [0,1]</p>
</dd></dl>

<dl class="function">
<dt id="pypillometry.convenience.p_asym_laplac_kappa">
<code class="sig-prename descclassname">pypillometry.convenience.</code><code class="sig-name descname">p_asym_laplac_kappa</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">mu</em>, <em class="sig-param">lam</em>, <em class="sig-param">kappa</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.p_asym_laplac_kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Asymmetric laplace distribution <a class="reference external" href="https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution">https://en.wikipedia.org/wiki/Asymmetric_Laplace_distribution</a>;
Wikipedia parametrization.</p>
<p>kappa in [0, infty] where 1 means symmetry</p>
</dd></dl>

<dl class="function">
<dt id="pypillometry.convenience.plot_pupil_ipy">
<code class="sig-prename descclassname">pypillometry.convenience.</code><code class="sig-name descname">plot_pupil_ipy</code><span class="sig-paren">(</span><em class="sig-param">tx</em>, <em class="sig-param">sy</em>, <em class="sig-param">event_onsets=None</em>, <em class="sig-param">overlays=None</em>, <em class="sig-param">overlay_labels=None</em>, <em class="sig-param">blinks=None</em>, <em class="sig-param">interpolated=None</em>, <em class="sig-param">figsize=(16</em>, <em class="sig-param">8)</em>, <em class="sig-param">xlab='ms'</em>, <em class="sig-param">nsteps=100</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.plot_pupil_ipy" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting with interactive adjustment of plotting window.
To use this, do</p>
<p>$ pip install ipywidgets
$ jupyter nbextension enable –py widgetsnbextension
$ jupyter labextension install &#64;jupyter-widgets/jupyterlab-manager</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tx</strong> (<em>np.ndarray</em>) – time-vector in seconds</p></li>
<li><p><strong>sy</strong> (<em>np.ndarray</em>) – raw pupil signal</p></li>
<li><p><strong>event_onsets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – onsets of events (stimuli/responses) in seconds</p></li>
<li><p><strong>overlays</strong> (<em>tuple of np.array</em>) – signals to overlay over the plot, given as tuple of arrays of same length as <cite>tx</cite></p></li>
<li><p><strong>overlay_labels</strong> (<em>tuple of strings</em>) – labels for the overlays to be displayed in the legend</p></li>
<li><p><strong>figsize</strong> (<em>tuple of int</em>) – dimensions for the plot</p></li>
<li><p><strong>xlab</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – label for x-axis</p></li>
<li><p><strong>nsteps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of steps for slider</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="pypillometry.convenience.trans_logistic_vec">
<code class="sig-prename descclassname">pypillometry.convenience.</code><code class="sig-name descname">trans_logistic_vec</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">a</em>, <em class="sig-param">b</em>, <em class="sig-param">inverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pypillometry.convenience.trans_logistic_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>vectorized version of trans_logistic()</p>
<p>goes from [a,b] to [-inf,+inf] and back;
inverse=False: [a,b] -&gt; [-inf, +inf]
inverse=True:  [-inf,+inf] -&gt; [a,b]
if a or b is +/-infty, a logarithmic/exponential transform is used</p>
</dd></dl>

</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="../genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="../py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="../search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/pypillometry_logo_200x200.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">API documentation</a><ul>
<li><a class="reference internal" href="#pupildata-py">pupildata.py</a></li>
<li><a class="reference internal" href="#io-py">io.py</a></li>
<li><a class="reference internal" href="#preproc-py">preproc.py</a></li>
<li><a class="reference internal" href="#fakedata-py">fakedata.py</a></li>
<li><a class="reference internal" href="#baseline-py">baseline.py</a></li>
<li><a class="reference internal" href="#pupil-py">pupil.py</a></li>
<li><a class="reference internal" href="#convenience-py">convenience.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="usage.html"
                        title="previous chapter">Overview</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dev.html"
                        title="next chapter">Developers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/docs/api.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev.html" title="Developers"
             >next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Overview"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">pypillometry  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Matthias Mittner.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>